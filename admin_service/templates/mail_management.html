{% extends "base.html" %}

{% block title %}老師傅後台管理系統{% endblock %}

{% block content %}
<link rel="stylesheet" href="../static/css/styles.css">
<link rel="stylesheet" href="../static/css/mail.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css">

<div class="container mt-5">
     <!-- 根據後端判斷是否已綁定信箱 -->
    {% if user_email %}
    <!-- 已綁定信箱的情況 ->
    <h2>需要更改您的信箱嗎？</h2>
    <p class="text-muted">於此處可通過刪除信箱並重新綁定，更改此帳戶已綁定的信箱地址。</p>
    <ul class="step-list">
        <li>1. 在上方輸入框內，確認貴公司目前綁定的信箱。</li>
        <li>2. 確認完畢後，點擊刪除此信箱，將會寄送一封驗證信到該信箱中。</li>
        <li>3. 驗證完成後，此信箱即被刪除。</li>
        <li>4. 刪除後，刷新頁面即可到尚未綁定狀態進行重新綁定信箱。</li>
    </ul>

    <form id="emailForm">
        <div class="mb-3">
            <label for="old_email" class="form-label">您目前的信箱：</label>
            <input type="email" class="form-control" id="old_email" name="old_email" value="{{ user_email }}" readonly>
        </div>
        <button type="submit" class="btn btn-danger">刪除此信箱</button>
    </form>-->

    {% else %} 
    <!-- 尚未綁定信箱的情況 -->
    <h2>首次綁定您的信箱</h2>
    <p class="text-muted">綁定帳戶可以更好的保護您的資料，通過完成帳戶綁定信箱，即可開始更改您的密碼。</p>
    <ul class="step-list">
        <li>1. 在輸入框內，輸入貴公司的信箱。</li>
        <li>2. 點擊發送驗證信後，將會送出一封驗證信到您輸入的信箱內。</li>
        <li>3. 完成驗證後刷新頁面即可前往帳戶管理中的修改密碼進行更動。</li>
    </ul>

    <form id="emailForm">
        <div class="mb-3">
            <label for="new_email" class="form-label">請輸入信箱:</label>
            <input type="email" class="form-control" id="new_email" name="new_email" placeholder="請輸入您的信箱" required>
        </div>
        <button type="submit" class="btn btn-primary">發送驗證信</button>
    </form>
    {% endif %}

    <!-- 顯示後端返回的消息 -->
    <div id="resultMessage" class="mt-3"></div>

    <!-- 加載動畫 -->
    <div id="loading" class="loading-spinner" style="display:none;">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
</div>
<script src="../static/js/mail_management.js"></script>
{% endblock %}